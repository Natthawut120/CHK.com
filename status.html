<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á | ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .status-container {
            padding: 20px;
        }

        .filter-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .filter-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: end;
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
        }

        .filter-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #495057;
        }

        .filter-group input,
        .filter-group select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 14px;
        }

        .btn-filter {
            padding: 8px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
        }

        .btn-filter:hover {
            background: #0056b3;
        }

        .btn-clear {
            padding: 8px 20px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
        }

        .btn-clear:hover {
            background: #545b62;
        }

        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 8px;
            color: white;
        }

        .stat-card.green {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        .stat-card.orange {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .stat-card h3 {
            margin: 0 0 10px 0;
            font-size: 14px;
            opacity: 0.9;
        }

        .stat-card .number {
            font-size: 32px;
            font-weight: bold;
            margin: 0;
        }

        .booking-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        .booking-table thead {
            background: #343a40;
            color: white;
        }

        .booking-table th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
        }

        .booking-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #dee2e6;
            font-size: 14px;
        }

        .booking-table tbody tr:hover {
            background: #f8f9fa;
        }

        .room-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .room-a {
            background: #e3f2fd;
            color: #1976d2;
        }

        .room-b {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        .room-hall {
            background: #fff3e0;
            color: #e65100;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .loading-overlay.hidden {
            display: none;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }

        .empty-state img {
            width: 120px;
            opacity: 0.5;
            margin-bottom: 20px;
        }

        .refresh-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
            transition: all 0.3s;
        }

        .refresh-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.6);
        }

        .refresh-btn:active {
            transform: scale(0.95);
        }

        @media (max-width: 768px) {
            .booking-table {
                font-size: 12px;
            }

            .booking-table th,
            .booking-table td {
                padding: 8px;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <aside class="panel-left">
            <div>
                <div class="brand">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQPAq1pMwudNfIv9Cbbe5zOF1livh6glO0fGg&s"
                        alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" class="logo">
                    <div>
                        <h1>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</h1>
                        <div class="intro">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÇ‡∏ä‡∏Ñ‡∏ä‡∏±‡∏¢‡∏™‡∏≤‡∏°‡∏±‡∏Ñ‡∏Ñ‡∏µ ‚Äî ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û</div>
                    </div>
                </div>

                <div class="info-list">
                    <div class="info-item"><b>‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£</b>
                        <div class="muted">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ‡πÄ‡∏ß‡∏•‡∏≤‡∏´‡πâ‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡∏î‡∏™‡πà‡∏á</div>
                    </div>
                    <div class="info-item"><b>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏à‡∏≠‡∏á</b>
                        <div class="muted">‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå - ‡∏®‡∏∏‡∏Å‡∏£‡πå 08:30 - 17:00</div>
                    </div>
                    <div class="info-item"><b>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</b>
                        <div class="muted">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏ß‡πà‡∏≤‡∏á</div>
                    </div>
                </div>
                <div class="tip">üí° ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏ö‡∏ö Real-time ‡∏à‡∏≤‡∏Å Google Sheets</div>
            </div>

            <div class="main" role="button" tabindex="0" aria-label="Main" style="cursor:pointer;display:inline-block;">
                <b>main</b>
                <div class="muted">‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</div>
            </div>

            <div class="status" role="button" tabindex="0" aria-label="status"
                style="cursor:pointer;display:inline-block;margin-top:10px;background:#667eea20;padding:10px;border-radius:8px;">
                <b>Status</b>
                <div class="muted">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß (‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏™‡∏î‡∏á)</div>
            </div>

            <script>
                const main = document.querySelector('.main');
                main.addEventListener('click', () => {
                    window.location.href = 'main.html';
                });

                main.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        window.location.href = 'main.html';
                    }
                });
            </script>
        </aside>

        <main class="panel-right">
            <div class="status-container">
                <h2>üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</h2>

                <!-- Filter Section -->
                <div class="filter-section">
                    <div class="filter-row">
                        <div class="filter-group">
                            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                            <input type="date" id="filterDate">
                        </div>
                        <div class="filter-group">
                            <label>‡∏´‡πâ‡∏≠‡∏á</label>
                            <select id="filterRoom">
                                <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° A">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° A</option>
                                <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° B">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° B</option>
                                <option value="‡∏´‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡∏´‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° C</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</label>
                            <input type="text" id="filterDepartment" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô...">
                        </div>
                        <button class="btn-filter" onclick="applyFilters()">üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                        <button class="btn-clear" onclick="clearFilters()">‚úñ ‡∏•‡πâ‡∏≤‡∏á</button>
                    </div>
                </div>

                <!-- Statistics -->
                <div class="stats-row">
                    <div class="stat-card">
                        <h3>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                        <p class="number" id="totalBookings">0</p>
                    </div>
                    <div class="stat-card green">
                        <h3>‡∏à‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h3>
                        <p class="number" id="todayBookings">0</p>
                    </div>
                    <div class="stat-card orange">
                        <h3>‡∏à‡∏≠‡∏á‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ</h3>
                        <p class="number" id="weekBookings">0</p>
                    </div>
                </div>

                <!-- Bookings Table -->
                <div id="tableContainer">
                    <table class="booking-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
                                <th>‡∏´‡πâ‡∏≠‡∏á</th>
                                <th>‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á</th>
                                <th>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</th>
                                <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô</th>
                                <th>‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå</th>
                            </tr>
                        </thead>
                        <tbody id="bookingTableBody">
                            <!-- Data will be inserted here -->
                        </tbody>
                    </table>
                </div>

                <div class="empty-state hidden" id="emptyState">
                    <p style="font-size: 48px;">üìÖ</p>
                    <h3>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h3>
                    <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ</p>
                </div>
            </div>
        </main>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div>
            <div class="spinner"></div>
            <p style="margin-top: 20px; font-weight: 600;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
        </div>
    </div>

    <!-- Refresh Button -->
    <button class="refresh-btn" onclick="loadBookings()" title="‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•">
        üîÑ
    </button>

    <script>
        // ‡πÉ‡∏™‡πà Web App URL ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
        const GOOGLE_SHEETS_URL = 'https://script.google.com/macros/s/AKfycbwbLpBBWN0QHa1mmF8y9u5dqVFF5t_r8iWnv7q5lB14jQRSlWMm3h-_Gmq-jugHUPqTjg/exec';

            async function loadBookings() {
                const overlay = document.getElementById('loadingOverlay');
                overlay.classList.remove('hidden');

                try {
                    const response = await fetch(GOOGLE_SHEETS_URL);
                    const data = await response.json();

                    allBookings = data.bookings || [];
                    filteredBookings = [...allBookings];

                    displayBookings(filteredBookings);
                    updateStatistics(allBookings);

                } catch (error) {
                    console.error('Error loading bookings:', error);
                    alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡∏Ç‡∏≠‡∏á Google Apps Script');
                } finally {
                    overlay.classList.add('hidden');
                }
            }

        function displayBookings(bookings) {
            const tbody = document.getElementById('bookingTableBody');
            const emptyState = document.getElementById('emptyState');
            const tableContainer = document.getElementById('tableContainer');

            if (bookings.length === 0) {
                tableContainer.style.display = 'none';
                emptyState.classList.remove('hidden');
                return;
            }

            tableContainer.style.display = 'block';
            emptyState.classList.add('hidden');

            tbody.innerHTML = bookings.map((booking, index) => {
                const roomClass = booking.room === '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° A' ? 'room-a' :
                    booking.room === '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° B' ? 'room-b' : 'room-hall';

                return `
          <tr>
            <td>${index + 1}</td>
            <td>${formatDate(booking.date)}</td>
            <td>${booking.startTime} - ${booking.endTime}</td>
            <td><span class="room-badge ${roomClass}">${booking.room}</span></td>
            <td>${booking.fullName}</td>
            <td>${booking.department}</td>
            <td>${booking.participants} ‡∏Ñ‡∏ô</td>
            <td>${booking.purpose || '-'}</td>
          </tr>
        `;
            }).join('');
        }

        function updateStatistics(bookings) {
            const today = new Date().toISOString().split('T')[0];
            const todayBookings = bookings.filter(b => b.date === today).length;

            const weekStart = new Date();
            weekStart.setDate(weekStart.getDate() - weekStart.getDay());
            const weekBookings = bookings.filter(b => {
                const bookingDate = new Date(b.date);
                return bookingDate >= weekStart;
            }).length;

            document.getElementById('totalBookings').textContent = bookings.length;
            document.getElementById('todayBookings').textContent = todayBookings;
            document.getElementById('weekBookings').textContent = weekBookings;
        }

        function applyFilters() {
            const filterDate = document.getElementById('filterDate').value;
            const filterRoom = document.getElementById('filterRoom').value;
            const filterDepartment = document.getElementById('filterDepartment').value.toLowerCase();

            filteredBookings = allBookings.filter(booking => {
                const matchDate = !filterDate || booking.date === filterDate;
                const matchRoom = !filterRoom || booking.room === filterRoom;
                const matchDept = !filterDepartment || booking.department.toLowerCase().includes(filterDepartment);

                return matchDate && matchRoom && matchDept;
            });

            displayBookings(filteredBookings);
        }

        function clearFilters() {
            document.getElementById('filterDate').value = '';
            document.getElementById('filterRoom').value = '';
            document.getElementById('filterDepartment').value = '';

            filteredBookings = [...allBookings];
            displayBookings(filteredBookings);
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            const thaiMonths = ['‡∏°.‡∏Ñ.', '‡∏Å.‡∏û.', '‡∏°‡∏µ.‡∏Ñ.', '‡πÄ‡∏°.‡∏¢.', '‡∏û.‡∏Ñ.', '‡∏°‡∏¥.‡∏¢.',
                '‡∏Å.‡∏Ñ.', '‡∏™.‡∏Ñ.', '‡∏Å.‡∏¢.', '‡∏ï.‡∏Ñ.', '‡∏û.‡∏¢.', '‡∏ò.‡∏Ñ.'];

            return `${date.getDate()} ${thaiMonths[date.getMonth()]} ${date.getFullYear() + 543}`;
        }
    </script>
</body>

</html>